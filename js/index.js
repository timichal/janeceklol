var Y=new Image;Y.src="public/janecek.png";var z=async({canvas:t,state:o})=>{let n=t.getContext("2d");n.fillStyle="black",n.fillRect(0,0,t.width,t.height);let s=t.width/o.image.width,r=t.height/o.image.height,i=Math.max(s,r);if(n.setTransform(i,0,0,i,0,0),n.drawImage(o.image,0,0),n.setTransform(),n.drawImage(Y,o.overlayCoords.x,o.overlayCoords.y,o.overlayCoords.width,o.overlayCoords.height),o.displayText){let v=95,d=95,p=750;n.font=`bold ${v}px 'bc-novatica-cyr'`;let C=o.text||"Tohle s memy",b=50,u=350;n.fillStyle="#f9dc4d",n.textBaseline="top",n.fillStyle="yellow";let N=C.split(" "),h="";N.forEach((X,j)=>{let k=`${h+X} `;n.measureText(k).width>p&&j>0?(n.fillText(h,b,u),h=`${X} `,u+=d):h=k}),n.fillText(h,b,u),u+=d}},c=z;var H=[{url:"https://source.unsplash.com/800x800?people",weight:10},{url:"https://source.unsplash.com/800x800?group",weight:5}],P=H.flatMap(({url:t,weight:o})=>Array(o).fill(t)),S=t=>t[Math.floor(Math.random()*t.length)],x=async()=>{let t=await fetch(S(P));return new Promise(o=>{let n=new Image;n.addEventListener("load",()=>o(n)),n.crossOrigin="anonymous",n.src=t.url})},w=async({image:t})=>new Promise((o,n)=>{t.type.startsWith("image/")||n();let s=new FileReader;s.readAsDataURL(t),s.addEventListener("load",r=>{let i=new Image;i.addEventListener("load",()=>o(i)),i.src=r.target.result})});var a=document.getElementById("picture"),E=a.getBoundingClientRect(),I=493,g=897,m=1.8,e={image:new Image,canvas:{offsetX:E.left,offsetY:E.top,scale:E.width/800},overlayCoords:{x:500,y:800-g/m,width:I/m,height:g/m,oldWidth:I/m,oldHeight:g/m},touch:{eventCache:[],prevDiff:-1},move:{startX:null,startY:null},isDragging:!1,displayText:!1,text:""},L=t=>{e.overlayCoords.width=I*(t/100),e.overlayCoords.height=g*(t/100),e.overlayCoords.x+=(e.overlayCoords.oldWidth-e.overlayCoords.width)/2,e.overlayCoords.y+=(e.overlayCoords.oldHeight-e.overlayCoords.height)/2,e.overlayCoords.oldWidth=e.overlayCoords.width,e.overlayCoords.oldHeight=e.overlayCoords.height,c({canvas:a,state:e})},B=t=>{let o=!!t.touches,n=Number((o?t.touches[0].clientX:t.clientX)-e.canvas.offsetX),s=Number((o?t.touches[0].clientY:t.clientY)-e.canvas.offsetY),r=e.overlayCoords.x*e.canvas.scale,i=e.overlayCoords.y*e.canvas.scale,v=e.overlayCoords.width*e.canvas.scale,d=e.overlayCoords.height*e.canvas.scale;n>r&&n<r+v&&s>i&&s<i+d&&(e.isDragging=!0),e.move.startX=n,e.move.startY=s};a.addEventListener("mousedown",B);a.addEventListener("touchstart",B);a.addEventListener("mouseup",()=>{e.isDragging=!1});var R=t=>{let o=!!t.touches,n=Number((o?t.touches[0].clientX:t.clientX)-e.canvas.offsetX),s=Number((o?t.touches[0].clientY:t.clientY)-e.canvas.offsetY),r=e.overlayCoords.x*e.canvas.scale,i=e.overlayCoords.y*e.canvas.scale,v=e.overlayCoords.width*e.canvas.scale,d=e.overlayCoords.height*e.canvas.scale;if(n>r&&n<r+v&&s>i&&s<i+d?a.style.cursor="pointer":a.style.cursor="initial",e.isDragging){let p=n-e.move.startX,C=s-e.move.startY;e.overlayCoords.x+=p/e.canvas.scale,e.overlayCoords.y+=C/e.canvas.scale,c({canvas:a,state:e}),e.move.startX=n,e.move.startY=s}};a.addEventListener("mousemove",R);a.addEventListener("touchmove",R);a.addEventListener("dragover",t=>t.preventDefault());a.addEventListener("drop",async t=>{t.preventDefault(),!(!t.dataTransfer||t.dataTransfer.files.length<=0)&&(e.image=await w({image:t.dataTransfer.files[0]}),c({canvas:a,state:e}))});var A=document.getElementById("randomize");A.addEventListener("click",async()=>{e.image=await x(),c({canvas:a,state:e})});var M=document.getElementById("customImage");M.addEventListener("change",async t=>{t.preventDefault(),!(t.target.files.length<=0)&&(e.image=await w({image:t.target.files[0]}),c({canvas:a,state:e}))});var U=document.getElementById("customImageBtn");U.addEventListener("click",()=>{M.click()});var T=document.getElementById("toggleText"),f=document.getElementById("customText");T.addEventListener("click",()=>{e.displayText=!e.displayText,T.innerText=T.innerText==="Přidat text"?"Odebrat text":"Přidat text",c({canvas:a,state:e})});var W=async t=>{(t.type==="input"||f.value)&&(e.text=f.value,c({canvas:a,state:e}))};f.addEventListener("click",W);f.addEventListener("input",W);var l=document.getElementById("slider");l.addEventListener("input",t=>{L(t.target.value),c({canvas:a,state:e})});var D=document.createElement("a");D.setAttribute("download","TohleJsmeMy.jpg");var $=document.getElementById("save");$.addEventListener("click",t=>{t.preventDefault(),D.setAttribute("href",a.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream")),D.click()});a.addEventListener("pointerdown",t=>e.touch.eventCache.push(t));a.addEventListener("pointermove",t=>{for(let o=0;o<e.touch.eventCache.length;o++)if(t.pointerId===e.touch.eventCache[o].pointerId){e.touch.eventCache[o]=t;break}if(e.touch.eventCache.length===2){let o=Math.abs(e.touch.eventCache[0].clientX-e.touch.eventCache[1].clientX);e.touch.prevDiff>0&&(o>e.touch.prevDiff&&(l.value=Number(l.value)+2,L(l.value)),o<e.touch.prevDiff&&(l.value=Number(l.value)-2,L(l.value))),e.touch.prevDiff=o}});var y=t=>{for(let o=0;o<e.touch.eventCache.length;o++)if(e.touch.eventCache[o].pointerId===t.pointerId){e.touch.eventCache.splice(o,1);break}e.touch.eventCache.length<2&&(e.touch.prevDiff=-1)};a.addEventListener("pointerup",y);a.addEventListener("pointercancel",y);a.addEventListener("pointerout",y);a.addEventListener("pointerleave",y);window.addEventListener("resize",()=>{let t=a.getBoundingClientRect();e.canvas={offsetX:t.left,offsetY:t.top,scale:t.width/800}});var O=async()=>{e.image=await x(),c({canvas:a,state:e})};O();
//# sourceMappingURL=index.js.map
